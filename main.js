// molecules in json format

var data = '[     {        "Formula":"NH_3",        "Name":"Ammonia",        "electron pair Geometry":"Tetrahedral",        "Central Atom":"N",        "Terminal Atom 1":"electron pair",        "Bond 1":"x",        "Terminal Atom 2":"H",        "Bond 2":"single",        "Terminal Atom 3":"H",        "Bond 3":"single",        "Terminal Atom 4":"H",        "Bond 4":"single",        "Terminal Atom 5":"none",        "Bond 5":"none",        "Terminal Atom 6":"none",        "Bond 6":"none",        "Molecular Geometry":"Trigonal pyramidal"     },     {        "Formula":"NF_3",        "Name":"Nitrogen trifluoride",        "electron pair Geometry":"Tetrahedral",        "Central Atom":"N",        "Terminal Atom 1":"electron pair",        "Bond 1":"x",        "Terminal Atom 2":"F",        "Bond 2":"single",        "Terminal Atom 3":"F",        "Bond 3":"single",        "Terminal Atom 4":"F",        "Bond 4":"single",        "Terminal Atom 5":"none",        "Bond 5":"none",        "Terminal Atom 6":"none",        "Bond 6":"none",        "Molecular Geometry":"Trigonal pyramidal"     },     {        "Formula":"CCl_4",        "Name":"Carbon tetrachloride",        "electron pair Geometry":"Tetrahedral",        "Central Atom":"C",        "Terminal Atom 1":"Cl",        "Bond 1":"single",        "Terminal Atom 2":"Cl",        "Bond 2":"single",        "Terminal Atom 3":"Cl",        "Bond 3":"single",        "Terminal Atom 4":"Cl",        "Bond 4":"single",        "Terminal Atom 5":"none",        "Bond 5":"none",        "Terminal Atom 6":"none",        "Bond 6":"none",        "Molecular Geometry":"Tetrahedral"     },     {        "Formula":"CO_2",        "Name":"Carbon Dioxide",        "electron pair Geometry":"Linear",        "Central Atom":"C",        "Terminal Atom 1":"O",        "Bond 1":"double",        "Terminal Atom 2":"O",        "Bond 2":"double",        "Terminal Atom 3":"none",        "Bond 3":"none",        "Terminal Atom 4":"none",        "Bond 4":"none",        "Terminal Atom 5":"none",        "Bond 5":"none",        "Terminal Atom 6":"none",        "Bond 6":"none",        "Molecular Geometry":"Linear"     },     {        "Formula":"H_2O",        "Name":"Water",        "electron pair Geometry":"Tetrahedral",        "Central Atom":"O",        "Terminal Atom 1":"electron pair",        "Bond 1":"x",        "Terminal Atom 2":"electron pair",        "Bond 2":"x",        "Terminal Atom 3":"H",        "Bond 3":"single",        "Terminal Atom 4":"H",        "Bond 4":"single",        "Terminal Atom 5":"none",        "Bond 5":"none",        "Terminal Atom 6":"none",        "Bond 6":"none",        "Molecular Geometry":"Bent"     },     {        "Formula":"BF_3",        "Name":"Boron trifluoride",        "electron pair Geometry":"Trigonal planar",        "Central Atom":"B",        "Terminal Atom 1":"F",        "Bond 1":"single",        "Terminal Atom 2":"F",        "Bond 2":"single",        "Terminal Atom 3":"F",        "Bond 3":"double",        "Terminal Atom 4":"none",        "Bond 4":"none",        "Terminal Atom 5":"none",        "Bond 5":"none",        "Terminal Atom 6":"none",        "Bond 6":"none",        "Molecular Geometry":"Trigonal planar"     },     {        "Formula":"BCl_3",        "Name":"Boron Trichloride",        "electron pair Geometry":"Trigonal planar",        "Central Atom":"B",        "Terminal Atom 1":"Cl",        "Bond 1":"single",        "Terminal Atom 2":"Cl",        "Bond 2":"single",        "Terminal Atom 3":"Cl",        "Bond 3":"single",        "Terminal Atom 4":"none",        "Bond 4":"none",        "Terminal Atom 5":"none",        "Bond 5":"none",        "Terminal Atom 6":"none",        "Bond 6":"none",        "Molecular Geometry":"Trigonal planar"     },     {        "Formula":"CClF_3",        "Name":"Chlorotrifluoromethane",        "electron pair Geometry":"Tetrahedral",        "Central Atom":"C",        "Terminal Atom 1":"Cl",        "Bond 1":"single",        "Terminal Atom 2":"F",        "Bond 2":"single",        "Terminal Atom 3":"F",        "Bond 3":"single",        "Terminal Atom 4":"F",        "Bond 4":"single",        "Terminal Atom 5":"none",        "Bond 5":"none",        "Terminal Atom 6":"none",        "Bond 6":"none",        "Molecular Geometry":"Tetrahedral"     },     {        "Formula":"SiCl_4",        "Name":"Silicon Tetrachloride",        "electron pair Geometry":"Tetrahedral",        "Central Atom":"Si",        "Terminal Atom 1":"Cl",        "Bond 1":"single",        "Terminal Atom 2":"Cl",        "Bond 2":"single",        "Terminal Atom 3":"Cl",        "Bond 3":"single",        "Terminal Atom 4":"Cl",        "Bond 4":"single",        "Terminal Atom 5":"none",        "Bond 5":"none",        "Terminal Atom 6":"none",        "Bond 6":"none",        "Molecular Geometry":"Tetrahedral"     },     {        "Formula":"CH_4",        "Name":"Methane",        "electron pair Geometry":"Tetrahedral",        "Central Atom":"C",        "Terminal Atom 1":"H",        "Bond 1":"single",        "Terminal Atom 2":"H",        "Bond 2":"single",        "Terminal Atom 3":"H",        "Bond 3":"single",        "Terminal Atom 4":"H",        "Bond 4":"single",        "Terminal Atom 5":"none",        "Bond 5":"none",        "Terminal Atom 6":"none",        "Bond 6":"none",        "Molecular Geometry":"Tetrahedral"     },     {        "Formula":"HNO_3",        "Name":"Nitric Acid",        "electron pair Geometry":"Trigonal planar",        "Central Atom":"N",        "Terminal Atom 1":"O",        "Bond 1":"double",        "Terminal Atom 2":"O",        "Bond 2":"single",        "Terminal Atom 3":"OH",        "Bond 3":"single",        "Terminal Atom 4":"none",        "Bond 4":"none",        "Terminal Atom 5":"none",        "Bond 5":"none",        "Terminal Atom 6":"none",        "Bond 6":"none",        "Molecular Geometry":"Trigonal planar"     },     {        "Formula":"CH_3Cl",        "Name":"Chloromethane",        "electron pair Geometry":"Tetrahedral",        "Central Atom":"C",        "Terminal Atom 1":"H",        "Bond 1":"single",        "Terminal Atom 2":"H",        "Bond 2":"single",        "Terminal Atom 3":"H",        "Bond 3":"single",        "Terminal Atom 4":"Cl",        "Bond 4":"single",        "Terminal Atom 5":"none",        "Bond 5":"none",        "Terminal Atom 6":"none",        "Bond 6":"none",        "Molecular Geometry":"Tetrahedral"     },     {        "Formula":"H_2S",        "Name":"Hydrogen Sulfide",        "electron pair Geometry":"Tetrahedral",        "Central Atom":"S",        "Terminal Atom 1":"H",        "Bond 1":"single",        "Terminal Atom 2":"H",        "Bond 2":"single",        "Terminal Atom 3":"electron pair",        "Bond 3":"x",        "Terminal Atom 4":"electron pair",        "Bond 4":"x",        "Terminal Atom 5":"none",        "Bond 5":"none",        "Terminal Atom 6":"none",        "Bond 6":"none",        "Molecular Geometry":"Bent"     },     {        "Formula":"PF_3",        "Name":"Phosphorus Trifluoride",        "electron pair Geometry":"Tetrahedral",        "Central Atom":"P",        "Terminal Atom 1":"F",        "Bond 1":"single",        "Terminal Atom 2":"F",        "Bond 2":"single",        "Terminal Atom 3":"F",        "Bond 3":"single",        "Terminal Atom 4":"electron pair",        "Bond 4":"x",        "Terminal Atom 5":"none",        "Bond 5":"none",        "Terminal Atom 6":"none",        "Bond 6":"none",        "Molecular Geometry":"Trigonal pyramidal"     },     {        "Formula":"CF_4",        "Name":"Carbon Tetrafluoride",        "electron pair Geometry":"Tetrahedral",        "Central Atom":"C",        "Terminal Atom 1":"F",        "Bond 1":"single",        "Terminal Atom 2":"F",        "Bond 2":"single",        "Terminal Atom 3":"F",        "Bond 3":"single",        "Terminal Atom 4":"F",        "Bond 4":"single",        "Terminal Atom 5":"none",        "Bond 5":"none",        "Terminal Atom 6":"none",        "Bond 6":"none",        "Molecular Geometry":"Tetrahedral"     },     {        "Formula":"H_2SO_4",        "Name":"Sulfuric Acid",        "electron pair Geometry":"Tetrahedral",        "Central Atom":"S",        "Terminal Atom 1":"O",        "Bond 1":"double",        "Terminal Atom 2":"O",        "Bond 2":"double",        "Terminal Atom 3":"OH",        "Bond 3":"single",        "Terminal Atom 4":"OH",        "Bond 4":"single",        "Terminal Atom 5":"none",        "Bond 5":"none",        "Terminal Atom 6":"none",        "Bond 6":"none",        "Molecular Geometry":"Tetrahedral"     },     {        "Formula":"CH_2Cl_2",        "Name":"Dichloromethane",        "electron pair Geometry":"Tetrahedral",        "Central Atom":"C",        "Terminal Atom 1":"H",        "Bond 1":"single",        "Terminal Atom 2":"H",        "Bond 2":"single",        "Terminal Atom 3":"Cl",        "Bond 3":"single",        "Terminal Atom 4":"Cl",        "Bond 4":"single",        "Terminal Atom 5":"none",        "Bond 5":"none",        "Terminal Atom 6":"none",        "Bond 6":"none",        "Molecular Geometry":"Tetrahedral"     },     {        "Formula":"CH_3OH",        "Name":"Methanol",        "electron pair Geometry":"Tetrahedral",        "Central Atom":"C",        "Terminal Atom 1":"H",        "Bond 1":"single",        "Terminal Atom 2":"H",        "Bond 2":"single",        "Terminal Atom 3":"H",        "Bond 3":"single",        "Terminal Atom 4":"OH",        "Bond 4":"single",        "Terminal Atom 5":"none",        "Bond 5":"none",        "Terminal Atom 6":"none",        "Bond 6":"none",        "Molecular Geometry":"Tetrahedral"     },     {        "Formula":"HCN",        "Name":"Hydrogen Cyanide",        "electron pair Geometry":"Linear",        "Central Atom":"C",        "Terminal Atom 1":"N",        "Bond 1":"triple",        "Terminal Atom 2":"H",        "Bond 2":"single",        "Terminal Atom 3":"none",        "Bond 3":"none",        "Terminal Atom 4":"none",        "Bond 4":"none",        "Terminal Atom 5":"none",        "Bond 5":"none",        "Terminal Atom 6":"none",        "Bond 6":"none",        "Molecular Geometry":"Linear"     },     {        "Formula":"CHCl_3",        "Name":"Chloroform",        "electron pair Geometry":"Tetrahedral",        "Central Atom":"C",        "Terminal Atom 1":"Cl",        "Bond 1":"single",        "Terminal Atom 2":"Cl",        "Bond 2":"single",        "Terminal Atom 3":"Cl",        "Bond 3":"single",        "Terminal Atom 4":"H",        "Bond 4":"single",        "Terminal Atom 5":"none",        "Bond 5":"none",        "Terminal Atom 6":"none",        "Bond 6":"none",        "Molecular Geometry":"Tetrahedral"     },     {        "Formula":"NH_4^+",        "Name":"Ammonium",        "electron pair Geometry":"Tetrahedral",        "Central Atom":"N",        "Terminal Atom 1":"H",        "Bond 1":"single",        "Terminal Atom 2":"H",        "Bond 2":"single",        "Terminal Atom 3":"H",        "Bond 3":"single",        "Terminal Atom 4":"H",        "Bond 4":"single",        "Terminal Atom 5":"none",        "Bond 5":"none",        "Terminal Atom 6":"none",        "Bond 6":"none",        "Molecular Geometry":"Tetrahedral"     },     {        "Formula":"CFCl_3",        "Name":"Trichlorofluoromethane",        "electron pair Geometry":"Tetrahedral",        "Central Atom":"C",        "Terminal Atom 1":"Cl",        "Bond 1":"single",        "Terminal Atom 2":"Cl",        "Bond 2":"single",        "Terminal Atom 3":"Cl",        "Bond 3":"single",        "Terminal Atom 4":"F",        "Bond 4":"single",        "Terminal Atom 5":"none",        "Bond 5":"none",        "Terminal Atom 6":"none",        "Bond 6":"none",        "Molecular Geometry":"Tetrahedral"     },     {        "Formula":"H_3O^+",        "Name":"Hydronium",        "electron pair Geometry":"Tetrahedral",        "Central Atom":"O",        "Terminal Atom 1":"H",        "Bond 1":"single",        "Terminal Atom 2":"H",        "Bond 2":"single",        "Terminal Atom 3":"H",        "Bond 3":"single",        "Terminal Atom 4":"electron pair",        "Bond 4":"x",        "Terminal Atom 5":"none",        "Bond 5":"none",        "Terminal Atom 6":"none",        "Bond 6":"none",        "Molecular Geometry":"Trigonal pyramidal"     },     {        "Formula":"BeCl_2",        "Name":"Beryllium Chloride",        "electron pair Geometry":"Linear",        "Central Atom":"Be",        "Terminal Atom 1":"Cl",        "Bond 1":"single",        "Terminal Atom 2":"Cl",        "Bond 2":"single",        "Terminal Atom 3":"none",        "Bond 3":"none",        "Terminal Atom 4":"none",        "Bond 4":"none",        "Terminal Atom 5":"none",        "Bond 5":"none",        "Terminal Atom 6":"none",        "Bond 6":"none",        "Molecular Geometry":"Linear"     },     {        "Formula":"ClO_4^-",        "Name":"Perchlorate",        "electron pair Geometry":"Tetrahedral",        "Central Atom":"Cl",        "Terminal Atom 1":"O",        "Bond 1":"single",        "Terminal Atom 2":"O",        "Bond 2":"single",        "Terminal Atom 3":"O",        "Bond 3":"single",        "Terminal Atom 4":"O",        "Bond 4":"single",        "Terminal Atom 5":"none",        "Bond 5":"none",        "Terminal Atom 6":"none",        "Bond 6":"none",        "Molecular Geometry":"Tetrahedral"     },     {        "Formula":"NO_3^-",        "Name":"Nitrate",        "electron pair Geometry":"Trigonal planar",        "Central Atom":"N",        "Terminal Atom 1":"O",        "Bond 1":"double",        "Terminal Atom 2":"O",        "Bond 2":"single",        "Terminal Atom 3":"O",        "Bond 3":"single",        "Terminal Atom 4":"none",        "Bond 4":"none",        "Terminal Atom 5":"none",        "Bond 5":"none",        "Terminal Atom 6":"none",        "Bond 6":"none",        "Molecular Geometry":"Trigonal planar"     },     {        "Formula":"BrF_3",        "Name":"Bromine Trifluoride",        "electron pair Geometry":"Trigonal Bipyramidal",        "Central Atom":"Br",        "Terminal Atom 1":"F",        "Bond 1":"single",        "Terminal Atom 2":"F",        "Bond 2":"single",        "Terminal Atom 3":"F",        "Bond 3":"single",        "Terminal Atom 4":"electron pair",        "Bond 4":"x",        "Terminal Atom 5":"electron pair",        "Bond 5":"x",        "Terminal Atom 6":"none",        "Bond 6":"none",        "Molecular Geometry":"T-shaped"     },     {        "Formula":"ICl_4^-",        "Name":"Tetrachloroiodide",        "electron pair Geometry":"Octahedral",        "Central Atom":"I",        "Terminal Atom 1":"Cl",        "Bond 1":"single",        "Terminal Atom 2":"Cl",        "Bond 2":"single",        "Terminal Atom 3":"Cl",        "Bond 3":"single",        "Terminal Atom 4":"Cl",        "Bond 4":"single",        "Terminal Atom 5":"electron pair",        "Bond 5":"x",        "Terminal Atom 6":"electron pair",        "Bond 6":"x",        "Molecular Geometry":"Square planar"     },     {        "Formula":"XeF_2",        "Name":"Xenon Difluoride",        "electron pair Geometry":"Trigonal Bipyramidal",        "Central Atom":"Xe",        "Terminal Atom 1":"F",        "Bond 1":"single",        "Terminal Atom 2":"F",        "Bond 2":"single",        "Terminal Atom 3":"electron pair",        "Bond 3":"x",        "Terminal Atom 4":"electron pair",        "Bond 4":"x",        "Terminal Atom 5":"electron pair",        "Bond 5":"x",        "Terminal Atom 6":"none",        "Bond 6":"none",        "Molecular Geometry":"Linear"     },     {        "Formula":"BrF_5",        "Name":"Bromine Pentafluoride",        "electron pair Geometry":"Octahedral",        "Central Atom":"Br",        "Terminal Atom 1":"F",        "Bond 1":"single",        "Terminal Atom 2":"F",        "Bond 2":"single",        "Terminal Atom 3":"F",        "Bond 3":"single",        "Terminal Atom 4":"F",        "Bond 4":"single",        "Terminal Atom 5":"F",        "Bond 5":"single",        "Terminal Atom 6":"electron pair",        "Bond 6":"x",        "Molecular Geometry":"Square pyramidal"     },     {        "Formula":"SF_6",        "Name":"Sulfur Hexafluoride",        "electron pair Geometry":"Octahedral",        "Central Atom":"S",        "Terminal Atom 1":"F",        "Bond 1":"single",        "Terminal Atom 2":"F",        "Bond 2":"single",        "Terminal Atom 3":"F",        "Bond 3":"single",        "Terminal Atom 4":"F",        "Bond 4":"single",        "Terminal Atom 5":"F",        "Bond 5":"single",        "Terminal Atom 6":"F",        "Bond 6":"single",        "Molecular Geometry":"Octahedral"     },     {        "Formula":"SCl_6",        "Name":"Sulfur Hexachloride",        "electron pair Geometry":"Trigonal Bipyramidal",        "Central Atom":"S",        "Terminal Atom 1":"Cl",        "Bond 1":"single",        "Terminal Atom 2":"Cl",        "Bond 2":"single",        "Terminal Atom 3":"Cl",        "Bond 3":"single",        "Terminal Atom 4":"Cl",        "Bond 4":"single",        "Terminal Atom 5":"Cl",        "Bond 5":"single",        "Terminal Atom 6":"Cl",        "Bond 6":"single",        "Molecular Geometry":"Octahedral"     },     {        "Formula":"SCl_4",        "Name":"Sulfur tetrachloride",        "electron pair Geometry":"Trigonal Bipyramidal",        "Central Atom":"S",        "Terminal Atom 1":"Cl",        "Bond 1":"single",        "Terminal Atom 2":"Cl",        "Bond 2":"single",        "Terminal Atom 3":"Cl",        "Bond 3":"single",        "Terminal Atom 4":"Cl",        "Bond 4":"single",        "Terminal Atom 5":"electron pair",        "Bond 5":"x",        "Terminal Atom 6":"none",        "Bond 6":"none",        "Molecular Geometry":"See-Saw"     },     {        "Formula":"XeCl_4",        "Name":"Xenon tetrafluoride",        "electron pair Geometry":"Octahedral",        "Central Atom":"Xe",        "Terminal Atom 1":"F",        "Bond 1":"single",        "Terminal Atom 2":"F",        "Bond 2":"single",        "Terminal Atom 3":"F",        "Bond 3":"single",        "Terminal Atom 4":"F",        "Bond 4":"single",        "Terminal Atom 5":"electron pair",        "Bond 5":"x",        "Terminal Atom 6":"electron pair",        "Bond 6":"x",        "Molecular Geometry":"Square planar"     },     {        "Formula":"XeCl_4",        "Name":"Xenon tetrachloride",        "electron pair Geometry":"Octahedral",        "Central Atom":"Xe",        "Terminal Atom 1":"Cl",        "Bond 1":"single",        "Terminal Atom 2":"Cl",        "Bond 2":"single",        "Terminal Atom 3":"Cl",        "Bond 3":"single",        "Terminal Atom 4":"Cl",        "Bond 4":"single",        "Terminal Atom 5":"electron pair",        "Bond 5":"x",        "Terminal Atom 6":"electron pair",        "Bond 6":"x",        "Molecular Geometry":"Square planar"     }  ]'


var selected;
var moleculeVars = ['NH_3', 'NF_3', 'CCl_4', 'CO_2', 'H_2O', 'BF_3', 'BCl_3', 'CClF_3', 'SiCl_4', 'CH_4', 'HNO_3', 'CH_3Cl', 'H_2S', 'PF_3', 'CF_4', 'H_2SO_4', 'CH_2Cl_2', 'CH_3OH', 'HCN', 'CHCl_3', 'NH_4^+', 'CFCl_3', 'H_3O^+', 'BeCl_2', 'ClO_4^-', 'NO_3^-', 'BrF_3', 'ICl_4^-', 'XeF_2', 'BrF_5', 'SF_6', 'SCl_6', 'SCl_4', 'XeCl_4', 'XeCl_4'];

// for the question statement; var molecules

var molecules = ['NH<sub>3</sub>', 'NF<sub>3</sub>', 'CCl<sub>4</sub>', 'CO<sub>2</sub>', 'H<sub>2</sub>O', 'BF<sub>3</sub>', 'BCl<sub>3</sub>', 'CClF<sub>3</sub>', 'SiCl<sub>4</sub>', 'CH<sub>4</sub>', 'HNO<sub>3</sub>', 'CH<sub>3</sub>Cl', 'H<sub>2</sub>S', 'PF<sub>3</sub>', 'CF<sub>4</sub>', 'H<sub>2</sub>SO<sub>4</sub>', 'CH<sub>2</sub>Cl<sub>2</sub>', 'CH<sub>3</sub>OH', 'HCN', 'CHCl<sub>3</sub>', 'NH<sub>4</sub><sup>+</sup>', 'CFCl<sub>3</sub>', 'H<sub>3</sub>O</sub><sup>+</sup>', 'BeCl<sub>2</sub>', 'ClO<sub>4</sub><sup>-</sup>', 'NO<sub>3</sub><sup>-</sup>', 'BrF<sub>3</sub>', 'ICl<sub>4</sub><sup>-</sup>', 'XeF<sub>2</sub>', 'BrF<sub>5</sub>', 'SCl<sub>6</sub>', 'SF<sub>6</sub>', 'SCl<sub>4</sub>', 'XeCl<sub>4</sub>', 'XeCl<sub>4</sub>'];

// random selection of molecule -- fixed int for testing
//var rand = Math.floor(Math.random() * molecules.length);
var rand = 18;


var mol = moleculeVars[rand];
document.getElementById("variationMol").innerHTML = molecules[rand];
var m = JSON.parse(data);
var n;

// response and answer objects (res is for an exact match -- preserved for demo only)

var res = {};
var answer = {};
var response = {};

// get corresponding JSON data

for (var i = 0; i < m.length; i++) {
  if (mol==m[i]["Formula"]) {
    n=m[i];
  }
}

// log for testing -- comment out for production
console.log(n);

function refreshPage(){
  window.location.reload();
} 

// initialize variables for the shell
var atom = ' ';
var target_box;
var currentMolecule = 'tri-bi';

// display the selected molecule
displayMolecule(currentMolecule);

/* Runs everytime the atom selection buttons are pressed */

jQuery("#element-table button").click(function(){
  atom = this.id;

  var icons = document.querySelectorAll("#element-table button");
  for (var i = 0; i < icons.length; i++) {
    icons[i].style.backgroundColor = "";
  }
  document.getElementById(atom).style.backgroundColor = "#FBFB92";

  var x = document.querySelectorAll("svg > circle, #legs circle");

  for (i = 0; i < x.length; i++) {
    x[i].style.fill = "#FBFB92";
    x[i].style.cursor = "pointer";
  }

});

/* Runs everytime the molecule placeholders are pressed (aka the big circles) */
  jQuery(".step2 p").click(function(e){
     target_box = this.id;
     target_box = target_box.match(/(\d+)/);
     target_box = parseFloat(target_box[0]);
      if (atom != "pair") {

        document.querySelectorAll("#" + currentMolecule + " p")[target_box - 1].innerHTML = atom;
      }
      else if(atom == "pair" && target_box != 1) {

        document.querySelectorAll("#" + currentMolecule + ' #legs > g')[target_box - 2].style.display = 'none';
        document.querySelectorAll("#" + currentMolecule + " p")[target_box - 1].style.display = 'none';
        document.querySelectorAll("#" + currentMolecule + ' #dots > g')[target_box - 2].style.display = 'inline-flex';
    }
  });

/* Runs everytime the lone pairs are pressed (aka the dots) */

  jQuery("#dots > g").click(function(e){

    var dotId = this.id;
    dotId = dotId.match(/(\d+)/);
    dotId = parseFloat(dotId[0]);

    var legs = document.querySelectorAll("#" + currentMolecule + " #legs > g");

    legs[(dotId - 1)].style.display = 'block';

    document.querySelectorAll("#" + currentMolecule + " p")[dotId].style.display = 'inline-flex';
    if(atom != "pair"){document.querySelectorAll("#" + currentMolecule + " p")[dotId].innerHTML = atom;}
    document.querySelectorAll("#" + currentMolecule + ' #dots > g')[dotId - 1].style.display = 'none';

  });


  /* Runs everytime a molecules bonds are pressed (aka the 1 - 3 lines) */

  jQuery("#legs > g > polygon").click(function(e){

    var displayCount = 0;
    var groupId = this.id;
    groupNum = groupId.match(/(\d+)/);
    groupNum = parseFloat(groupNum[0]);

    var lines = document.querySelectorAll("#" + currentMolecule + " #legs #leg" + groupNum + ' line');

    var polygons = document.querySelectorAll("#" + currentMolecule + " #legs #leg" + groupNum + ' > g > polygon');
    var amount = polygons.length;

      for(var i = 0; i < lines.length; i++){
        if(lines[i].style.display == 'block'){
          displayCount++;
        }
      }
      if(amount == 0){
        switch(displayCount){
          case 1:
            lines[0].style.display = 'block';
            lines[1].style.display = 'none';
            lines[2].style.display = 'block';
            break;
          case 2:
            lines[1].style.display = 'block';
            break;
          case 3:
            lines[0].style.display = 'none';
            lines[2].style.display = 'none';
            break;
          default:
          lines[0].style.display = 'none';
          lines[1].style.display = 'block';
          lines[2].style.display = 'none';
        }
    }else{
        switch(displayCount) {
          case 1:
            lines[0].style.display = 'block';
            lines[1].style.display = 'none';
            lines[2].style.display = 'block';
            break;
          case 2:
            lines[1].style.display = 'block';
            break;
          case 3:
            for(var i = 0; i < amount; i++){
              polygons[i].style.display = 'block';
            }
            lines[0].style.display = 'none';
            lines[1].style.display = 'none';
            lines[2].style.display = 'none';
            break;
          default:
          for(var i = 0; i < amount; i++){
            polygons[i].style.display = 'none';
          }
          lines[0].style.display = 'block';
          lines[2].style.display = 'block';
        }
      }

  });

  /* runs when step one dropdown changes */

  function displayMolecule(value){
    var molecules = document.querySelectorAll(".shell div");
    for(var i = 0; i < molecules.length; i++){
      molecules[i].style.display = 'none';
    }
    currentMolecule = value;
    document.getElementById(value).style.display = 'block';
  }

  /* runs when the "Clear" button is clicked */

  function clearCanvas() {

    // remove atoms from circles, reset styles
    var atoms = document.querySelectorAll("."+currentMolecule+"-atom");
    for(var i = 0; i < atoms.length; i++){
      atoms[i].innerHTML = "";
      atoms[i].style.display = "";
    }

    // unhighlight element button
    var icons = document.querySelectorAll("#element-table button");
    for (var i = 0; i < icons.length; i++) {
      icons[i].style.backgroundColor = "";
    }

    // remove electron pair
    var dots = document.querySelectorAll("#" + currentMolecule + ' #dots > g')
    for(var i = 0; i < dots.length; i++){
      dots[i].style.display = 'none';
    }

    // restore circles
    var x = document.querySelectorAll("svg > circle, g > circle, #legs > g");
    for (i = 0; i < x.length; i++) {
      x[i].style.display = 'block';
      x[i].style.fill = "";
    }

  // reset answer and response
    answer = {};
    response = {};
  }

/* runs when the "Submit" button is clicked */

  function submit() {

    answer = {};
    response = {};
    var getAtoms = [];
    
    // get atoms and add results to res object
    var atoms = document.querySelectorAll("."+currentMolecule+"-atom");
    for(var i = 0; i < 7; i++){
      if (i >= atoms.length) {
        getAtoms.push("none");
      }
      else {
        var a = atoms[i].innerHTML;
        if (a.length<1) {
          getAtoms.push("electron pair");
        }
        else {
        getAtoms.push(a);
        }
      }

      }

      res["Central Atom"] = getAtoms[0];
      response["Central Atom"] = getAtoms[0];

      for(var i = 1; i < getAtoms.length; i++){

        var a;

        if (getAtoms[i]=="none") {
          a="no atom"
        }
        else {
          a=getAtoms[i]
        }


        if (a in response) {
          response[a]+=1;
        }
        else {
          response[a]=1;
        }

      }

      res["Terminal Atom 6"] = getAtoms[6];
      res["Terminal Atom 5"] = getAtoms[5];
      res["Terminal Atom 4"] = getAtoms[4];
      res["Terminal Atom 3"] = getAtoms[3];
      res["Terminal Atom 2"] = getAtoms[2];
      res["Terminal Atom 1"] = getAtoms[1];

    
    var legs = document.querySelectorAll("."+currentMolecule + "-leg");
    nums = [];
    for(var k = 0; k < 6; k++){
      
      if (k >= legs.length) {
        nums.push("none");
      }

      else {

        var ch = legs[k].children;
        var num = 0;

        for(var m = 0; m < ch.length; m++){

          var i = ch[m].id;
          
          if (i.includes("line") && i.includes("Zone")==false) {
            var s = ch[m].getAttribute("style");

            if (s !== null && s.includes("block")) {
              num+=1;
            }
          }
        }
        nums.push(num);
      }
    }

    for(var i = 0; i < 7; i++){
      if (getAtoms[i]=="electron pair") {
        nums[i-1]='x';
      }
      if (nums[i]<2) {
        nums[i]="single";
      }
      if (nums[i]==2) {
        nums[i]="double";
      }
      if (nums[i]==3) {
        nums[i]="triple";
      }
    }

    for(var i = 0; i < nums.length; i++){

      var b;

      if (nums[i]=="none") {
        b="no bond"
      }
      else {
        b=nums[i]
      }

      if (b in response) {
        response[b]+=1;
      }
      else {
        response[b]=1;
      }

    }

    res["Bond 1"] = nums[0];
    res["Bond 2"] = nums[1];
    res["Bond 3"] = nums[2];
    res["Bond 4"] = nums[3];
    res["Bond 5"] = nums[4];
    res["Bond 6"] = nums[5];

    var molGeo = document.getElementById("mol-geometry");
    var g = molGeo.value;

    var gnames = ["tri-bi","tri-planar","linear","tetrahedral","octahedral", "square-planar", "square-pyramidal", "see-saw", "t-shaped", "bent"];
    var gnames_new = ["Trigonal pyramidal",
    "Trigonal planar",
    "Linear",
    "Tetrahedral",
    "Octahedral",
    "Square planar",
    "Square pyramidal",
    "See-Saw",
    "T-shaped",
    "Bent"];
    var gNew = gnames.indexOf(g);

    res["Molecular Geometry"] = n["Molecular Geometry"];
    response["Molecular Geometry"] = gnames_new[gNew];
    answer["Molecular Geometry"] = n["Molecular Geometry"];
  
    response["Name"] = n["Name"];

    res["Name"] = n["Name"];
    answer["Name"] = n["Name"];
    response["Formula"] = n["Formula"];
    res["Formula"] = n["Formula"];
    answer["Formula"] = n["Formula"];

    var names = ["tri-bi","tri-planar","linear","tetrahedral","octahedral"];
    var names_new = ["Trigonal Bipyramidal","Trigonal planar","Linear","Tetrahedral","Octahedral"];
    var mi = names.indexOf(currentMolecule);

    res["electron pair Geometry"]=names_new[mi];
    response["electron pair Geometry"]=names_new[mi];
    answer["electron pair Geometry"]=names_new[mi];

    answer["Central Atom"]=n["Central Atom"];

    
    for (let i in n) {
      if (i.includes("Terminal")) {
        var a;
        if (n[i]=="none") {
          a="no atom"
        }
        else {
          a=n[i];
        }
        if (a in answer) {
          answer[a]+=1;
        }
        else {
          answer[a]=1;
        } 
      }
      if (i.includes("Bond")) {
        var b;
        if (n[i]=="none") {
          b="no bond"
        }
        else {
          b=n[i];
        }
        if (b in answer) {
          answer[b]+=1;
        }
        else {
          answer[b]=1;
        } 
      }


    }


// console log for testing -- comment out in production

    console.log(response);
    console.log(answer);


    if (isEquivalent(answer,response)) {
      fb.innerHTML = "Correct!";
    }
    else {
      fb.innerHTML = "Incorrect";
    }

  }

    
  /*
check is structures match
*/

function isEquivalent(a, b) {
  // Create arrays of property names
  var aProps = Object.getOwnPropertyNames(a);
  var bProps = Object.getOwnPropertyNames(b);

  // If number of properties is different,
  // objects are not equivalent
  if (aProps.length != bProps.length) {
      return false;
  }

  for (var i = 0; i < aProps.length; i++) {
      var propName = aProps[i];

      // If values of same property are not equal,
      // objects are not equivalent
      if (a[propName] !== b[propName]) {
          return false;
      }
  }

  // If we made it this far, objects
  // are considered equivalent
  return true;
  
}


// When the user scrolls down 50px from the top of the document, resize the header's size
window.onscroll = function() {scrollFunction()};

function scrollFunction() {
  if (document.body.scrollTop > 50 || document.documentElement.scrollTop > 50) {
    document.getElementById("headTitle").style.fontSize = "18px";
    document.getElementById("headTitle").innerHTML = molecules[rand];
    document.getElementsByClassName("header")[0].style.padding = "0";
    document.getElementsByClassName("header")[0].style.opacity = "0.9";
    document.getElementsByClassName("header")[0].style.height = "50px"; 
  } 
  else {
    document.getElementById("headTitle").style.fontSize = "28px";
    document.getElementById("headTitle").innerHTML = "Molecular Geometry";
    document.getElementsByClassName("header")[0].style.padding = "10px 16px";
    document.getElementsByClassName("header")[0].style.opacity = "1"; 
  }
}